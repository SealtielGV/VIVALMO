<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="vivalmo_mrp_bom_report" name="bill_of_materials">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="bom">
                <t t-call="web.external_layout">  
                    <div class="page">
                        <div t-if="bom.x_studio_fotografa" class="row" style="margin-botton:50px;">
                            <div class="col-6 text-center" style="margin-top:100px;">
                                <h3><span t-field="bom.code" /></h3>
                            </div>
                            <div class="col-6 text-right">
                              <img t-attf-src="data:image/*;base64,{{bom.x_studio_fotografa}}" style="width:249;height:249px;"/>   
                            </div>
                        </div>
                        <div t-else="" class="row" style="margin-botton:50px;">
                            <div class="col-12 text-center" style="margin-top:100px;">
                                <h3><span t-field="bom.code" /></h3>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-6">
                                <div t-if="bom.x_studio_temporada" class="col-12">
                                    <strong>Temporada: </strong> <span t-field="bom.x_studio_temporada" />
                                </div>
                                <div t-if="bom.x_studio_canal_de_venta" class="col-12">
                                    <strong>Canal de venta: </strong> <span t-field="bom.x_studio_canal_de_venta" />
                                </div>
                                <div t-if="bom.product_tmpl_id.name" class="col-12">
                                    <strong>Nodelo: </strong> <span t-field="bom.product_tmpl_id.name" />
                                </div>
                                <div t-if="bom.x_studio_segmento" class="col-12">
                                    <strong>Segmento: </strong> <span t-field="bom.x_studio_segmento" />
                                </div>
                                <div t-if="bom.x_studio_tallas_a_fabricar" class="col-12">
                                    <strong>Tallas a fabricar: </strong> <span t-esc="','.join(bom.x_studio_tallas_a_fabricar.mapped('name'))" />
                                </div>
                            </div>

                            <div class="col-6">
                                <div t-if="bom.x_studio_color" class="col-12" >
                                    <strong>Color: </strong> <span t-esc="','.join(bom.x_studio_color.mapped('name'))" />
                                </div>
                                <div t-if="bom.x_studio_fit_bom" class="col-12">
                                    <strong>Fit: </strong> <span t-esc="','.join(bom.x_studio_fit_bom.mapped('x_studio_color_lavado'))" />
                                </div>
                                <div t-if="bom.x_studio_estilos_bom" class="col-12">
                                    <strong>Estilos: </strong> 
                                    <span t-esc="','.join(bom.x_studio_estilos_bom.mapped('name'))" />
                                </div>
                                <div t-if="bom.x_studio_instrucciones_de_lavado" class="col-12">
                                    <strong>Instrucciones de lavado húmedos: </strong> 
                                    <span t-esc="','.join(bom.x_studio_instrucciones_de_lavado.mapped('name'))" />
                                </div>
                                <div t-if="bom.x_studio_instrucciones_de_lavado_secos" class="col-12">
                                    <strong>Instrucciones de lavado secos: </strong> 
                                    <span t-esc="','.join(bom.x_studio_instrucciones_de_lavado_secos.mapped('name'))" />
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-6">
                                <div t-if="bom.company_id" class="col-12">
                                    <strong>Fabricante: </strong> <span t-field="bom.company_id.name" />
                                </div>
                                <div t-if="bom.x_studio_disenador_bom" cclass="col-12">
                                    <strong>Diseñador: </strong> <span t-field="bom.x_studio_disenador_bom.name" />
                                </div>
                                <div t-if="bom.type" class="col-12">
                                    <strong>Tipo de LdM: </strong> <span t-field="bom.type" />
                                </div>
                                <div  class="col-12">
                                    <strong>Total de materiales: </strong> <span t-field="bom.x_studio_total_de_materiales" />
                                </div>
                                <div  class="col-12">
                                    <strong>Total de servicios: </strong> <span t-field="bom.x_studio_total_de_servicios" />
                                </div>
                                <div  class="col-12">
                                    <strong>Costos indirectos: </strong> <span t-field="bom.x_studio_costos_indirectos" />
                                </div>
                                <div  class="col-12">
                                    <strong>Costo total: </strong> <span t-field="bom.x_studio_costo_total" />
                                </div>
                                <div  class="col-12">
                                    <strong>Precio de venta: </strong> <span t-field="bom.x_studio_precio_de_venta_bom" />
                                </div>
                                <div  class="col-12">
                                    <strong>Descuento: </strong> <span t-field="bom.x_studio_descuento_bom" />
                                </div>
                                <div class="col-12">
                                    <strong>Utilidad en MXN: </strong> <span t-field="bom.x_studio_utilidad_en_mxn_bom" />
                                </div>
                                <div  class="col-12">
                                    <strong>Utilidad en %: </strong> <span t-field="bom.x_studio_utilidad_porcentual_bom" />
                                </div>
                            </div>
                            <div class="col-6">
                                <div  class="col-12">
                                    <strong>Operación: </strong> <span t-field="bom.picking_type_id.name" />
                                </div>
                                <div  class="col-12">
                                    <strong>Consumo: </strong> <span t-field="bom.consumption" /> 
                                </div>
                                <div   class="col-12">
                                    <strong>SE00001 Servicio de corte: </strong> <span t-field="bom.x_studio_se00001_servicio_de_corte" /> 
                                </div>
                                <div   class="col-12">
                                    <strong>SE00002 Servicio de bordado: </strong> <span t-field="bom.x_studio_se00002_servicio_de_bordado" /> 
                                </div>
                                <div   class="col-12">
                                    <strong>SE00003 Servicio de costura: </strong> <span t-field="bom.x_studio_se00003_servicio_de_costura" /> 
                                </div>
                                <div  class="col-12">
                                    <strong>SE00004 Servicio de lavado: </strong> <span t-field="bom.x_studio_se00004_servicio_de_lavado" />
                                </div>
                                <div   class="col-12">
                                    <strong>SE00005 Servicio de terminado:</strong> <span t-field="bom.x_studio_se00005_servicio_de_terminado" /> 
                                </div>
                                <div  class="col-12">
                                    <strong>Total de servicios: </strong> <span t-field="bom.x_studio_total_de_servicios" />
                                </div>
                            </div>
                        </div>
                        <table class="table table-sm o_main_table  table-striped ">
                            <thead>
                                <tr>
                                    <th name="th_component">Componente</th>
                                    <th name="th_description">Descripción</th>
                                    <th name="th_quantity">Cantidad</th>
                                    <th name="th_cost">Costo</th>
                                    <th name="th_total">Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="bom.bom_line_ids" t-as="line">
                                    <tr>
                                        <td name="td_component">
                                            <span t-field="line.product_id.name" />
                                        </td>
                                        <td name="td_description">
                                            <span t-field="line.x_studio_descripcion" />
                                        </td>
                                        <td name="td_quantity">
                                            <span t-field="line.product_qty" />
                                            <span t-field="line.product_uom_id.name" />
                                        </td>
                                        <td name="td_cost">
                                            <span t-field="line.x_studio_costo" />
                                        </td>
                                        <td name="td_total">
                                            <span t-field="line.amount_total"/>
                                        </td>
                                    </tr>
                                </t>
                                
                            </tbody>
                        </table>                      
                    </div>
                </t>
            </t>
        </t>
    </template>

    <report
        id = "vivalmo_bill_of_material_report"
        string = "Lista de Materiales Reporte"
        model = "mrp.bom"
        report_type = "qweb-pdf"
        name = "material_cost.vivalmo_mrp_bom_report"
        file = "material_cost.vivalmo_mrp_bom_report"
        print_report_name="'Lista de Material #%s' % (object.display_name)"/>

</odoo>